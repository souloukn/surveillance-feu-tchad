/* style.css - Thème sombre + Grid Layout 2 Colonnes (Sidebar + Map) + Nouveaux Contrôles */

/* --- Base Styles & Reset --- */
*, *::before, *::after {
    box-sizing: border-box; /* Include padding and border in the element's total width and height */
}

body {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
    background-color: #1e1e1e; /* Dark background */
    margin: 0;
    padding: 0;
    line-height: 1.6;
    color: #cccccc; /* Light grey text */
    min-height: 100vh; /* Ensure body takes at least the full viewport height */
    display: flex;
    flex-direction: column; /* Stack children (header, main, footer) vertically */
    overflow-x: hidden; /* Prevent horizontal scrolling caused by wide elements */
    /* overflow-y: auto; /* Allow body to scroll vertically if overall content exceeds viewport height - Usually better to manage scroll on specific containers */
}

/* Define CSS variables for heights/paddings for height calculations */
body {
    --header-min-height: 50px; /* Approx height of logo */
    --header-padding-vertical: 1.6rem; /* 0.8rem * 2 */
    --header-margin-bottom: 0.8rem;
    --footer-min-height: 0.8rem; /* Approx footer text height */
    --footer-padding-vertical: 1.6rem; /* 0.8rem * 2 */
    --main-padding-vertical: 0.8rem; /* 0.8rem at top and bottom */
    --main-padding-bottom: 0.8rem; /* Just the bottom padding of main */
    --main-gap: 0.8rem; /* Gap used in main grid/flex */
}

/* --- Header --- */
header {
    background-color: #282828; /* Header background */
    color: #eeeeee; /* Header text */
    padding: 0.8rem 1.5rem; /* Adjusted padding */
    margin-bottom: 0.8rem;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3); /* Slight shadow */
    text-align: left; /* Default text alignment */
    position: relative; /* Needed for absolute positioning of refresh indicator */
    flex-shrink: 0; /* Prevent header from shrinking */
    z-index: 2; /* Ensure header is above main content */
}

header .header-content {
    display: flex; /* Enable Flexbox for logo and title alignment */
    align-items: center; /* Vertical alignment in the center */
    max-width: 1600px; /* Limit header content width */
    margin: 0 auto; /* Center header content */
    gap: 1rem; /* Space between flex items (logo and text group) */
}

/* Style for the logo */
header .site-logo {
    height: var(--header-min-height); /* Logo height */
    flex-shrink: 0; /* Prevent logo from shrinking */
    object-fit: contain; /* Ensure image doesn't distort */
}

/* Container for the title and subtitle */
header .header-title-group {
    flex-grow: 1; /* Allow text group to take remaining space */
    text-align: left; /* Ensure text inside is left-aligned */
}

header .header-title-group h1 {
    margin: 0;
    font-size: 2rem;
    font-weight: 600;
    color: #00bcd4; /* Accent color for title */
}

header .header-title-group p {
    margin-top: 0.3rem;
    font-size: 1rem;
    opacity: 0.8; /* Slightly transparent text */
}

/* Auto Refresh Indicator */
.auto-refresh-indicator {
    position: absolute; /* Position relative to the header */
    top: 10px; /* Distance from the top */
    right: 10px; /* Distance from the right */
    font-size: 0.85rem; /* Font size */
    color: #aaaaaa; /* Text color */
    background-color: #333; /* Slightly darker background */
    padding: 0.3rem 0.6rem;
    border-radius: 4px;
    z-index: 10; /* Ensure it's above other header elements */
}
.auto-refresh-indicator #refresh-countdown {
    font-weight: bold;
    color: #eeeeee; /* Countdown color */
}


/* --- Main Content Layout (using CSS Grid - 2 Columns) --- */
main {
    flex-grow: 1; /* Allow main content to take remaining vertical space */
    padding: 0 var(--main-padding-vertical) var(--main-padding-bottom) var(--main-padding-vertical); /* Padding around main content */
    max-width: 1600px; /* Max width of the dashboard area */
    margin: 0 auto; /* Center main content */
    display: grid; /* Activate Grid layout */
    grid-template-areas: "sidebar map"; /* Define grid areas */
    /* Sidebar fixed width (320px), map takes remaining space (1fr) */
    grid-template-columns: 320px 1fr;
    grid-template-rows: 1fr; /* **FIX:** One row that takes all available height in the grid container */
    gap: var(--main-gap); /* Space between grid items (sidebar and map) */
    width: 100%; /* Ensure main uses full width up to max-width */
    min-height: 0; /* Allow flex item (main) to shrink below its content's minimum size */

    /* **FIX:** Calculate remaining height for main based on header and footer */
    /* This ensures the grid container has a definite height for 1fr row to work */
    /* Adjust calculation if header/footer height changes */
    height: calc(100vh - (var(--header-min-height) + var(--header-padding-vertical) + var(--header-margin-bottom)) - (var(--footer-min-height) + var(--footer-padding-vertical)) - (var(--main-padding-bottom)));
    /* Note: This calc might be complex and depends on box-sizing. Test carefully. */
    /* Alternative: simpler fixed height like height: 80vh; but less flexible */
    /* Let's stick with the calc for now, ensuring box-sizing: border-box is everywhere */
}


/* --- Left Sidebar Container --- */
#left-sidebar {
    grid-area: sidebar; /* Positionne dans la zone de grille 'sidebar' */
    display: flex; /* Utilise Flexbox pour empiler les sections verticalement */
    flex-direction: column;
    gap: 0.8rem; /* Espace entre les sections */
    overflow-y: auto; /* **FIX:** Adds vertical scrollbar if content overflows */
    background-color: #282828; /* Background matching sections */
    padding: 0.8rem; /* Uniform padding inside the sidebar */
    border-radius: 4px;
    max-height: 100%; /* **FIX:** Crucial for overflow-y: auto to work within grid cell's 1fr height */
    box-sizing: border-box; /* **FIX:** Ensure padding is included in max-height */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); /* Add sidebar container shadow */
}

/* Styles génériques pour les sections inside the sidebar */
#left-sidebar section {
    background-color: transparent; /* Make section background transparent */
    padding: 0; /* Remove section padding, apply padding to inner content */
    border-radius: 4px;
    overflow: hidden; /* Manage content overflow within the section */
    display: flex;
    flex-direction: column;
    flex-shrink: 0; /* Prevent sections from shrinking unnaturally */
    box-shadow: none; /* Remove shadow on sections if sidebar has one */
     margin-bottom: 0; /* Remove margin between sections as gap is on parent */
     /* Add a subtle border to separate sections */
     border: 1px solid #333;
}


/* Styles des titres de section (in the sidebar) - Used as collapsible headers */
#left-sidebar section h2 {
    color: #00bcd4; /* Accent color for titles */
    margin: 0;
    padding: 0.8rem 1rem; /* Padding for the clickable header */
    font-size: 1.3rem; /* Adjusted font size for sidebar titles */
    font-weight: 600;
    background-color: #333; /* Slightly darker background for header */
    cursor: pointer; /* Indicate it's cliquable */
    user-select: none; /* Prevent text selection on click */
    display: flex; /* Use flex to align title and optional icon */
    justify-content: space-between; /* Space out title and icon */
    align-items: center;
    border-bottom: 1px solid #444; /* Separator line */
    transition: border-bottom 0.3s ease; /* Transition for the border */
    flex-shrink: 0; /* Prevent header from shrinking */
     border-top-left-radius: 3px; /* Match parent border-radius - slightly smaller */
     border-top-right-radius: 3px;
     background-color: #3a3a3a; /* Slightly different background for header */
}
#left-sidebar section:first-child h2 { border-top-left-radius: 4px; border-top-right-radius: 4px; } /* Match sidebar radius for first section header */


/* Add arrow indicator to headers */
#left-sidebar section h2.collapsible-header::after {
    content: '▼'; /* Down arrow */
    display: inline-block;
    margin-left: 10px;
    transition: transform 0.3s ease;
    font-size: 0.8em;
    color: #aaaaaa;
}

/* Rotate arrow when section is expanded */
#left-sidebar section.expanded h2.collapsible-header::after {
    transform: rotate(180deg); /* Up arrow */
}

/* Styles for the collapsible content wrapper managed by JS */
#left-sidebar section .section-content {
    padding: 1rem; /* Add padding back to the content area */
    max-height: 2000px; /* **Adjusted:** A larger value to ensure content fits when expanded */
    overflow: hidden; /* Hide content when max-height is restricted */
    transition: max-height 0.3s ease-out, padding-top 0.3s ease-out, padding-bottom 0.3s ease-out; /* Smooth transition */
     border-top: 1px solid #444; /* Border between header and content */
     box-sizing: border-box; /* Include padding in max-height */
     flex-grow: 1; /* Allow content to grow if needed within section (e.g., table) */
     display: flex; /* Use flex to stack content elements inside */
     flex-direction: column;
     /* Added rounded bottom corners to content */
     border-bottom-left-radius: 4px;
     border-bottom-right-radius: 4px;
}

/* State when section is collapsed - Managed by the class added by JS */
#left-sidebar section.collapsed .section-content {
    max-height: 0; /* Collapse the content */
    padding-top: 0; /* Remove padding when collapsed */
    padding-bottom: 0;
    visibility: hidden; /* Hide content visually without affecting layout flow excessively */
     border-top: none; /* No border when collapsed */
}

/* Remove bottom border from header when section is collapsed */
#left-sidebar section.collapsed h2 {
     border-bottom: none;
     border-bottom-left-radius: 4px; /* Round bottom corners of header when collapsed */
     border-bottom-right-radius: 4px;
}


/* --- Specific Section Styles (within the sidebar) --- */

/* Stats Panel */
#stats-section .metric {
    margin-bottom: 1rem; /* Espace entre les métriques */
    padding-bottom: 1rem;
    border-bottom: 1px solid #333; /* Séparateur */
    display: flex; /* Utilise flex pour empiler nombre et label */
    flex-direction: column;
}
#stats-section .metric:last-child { border-bottom: none; padding-bottom: 0; margin-bottom: 0;} /* Pas de bordure/margin sous la dernière métrique */
#stats-section .metric .number {
    font-size: 2.8rem;
    font-weight: 700;
    color: #eeeeee;
    margin-bottom: 0.2rem;
}
#stats-section .metric .label {
    font-size: 0.9rem;
    color: #cccccc;
    text-transform: uppercase;
    opacity: 0.9;
}

/* Date Filters Panel */
#filter-section .filter-group {
    margin-bottom: 0.8rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}
#filter-section label {
    flex-shrink: 0; /* Prevent label from shrinking */
    font-size: 0.9rem;
    color: #cccccc;
    min-width: 90px; /* Minimum width for labels */
}
#filter-section input[type="date"] {
    flex-grow: 1; /* Input takes remaining space */
    background-color: #333;
    color: #eeeeee;
    border: 1px solid #555;
    padding: 0.4rem 0.6rem;
    border-radius: 4px;
    font-size: 0.9rem;
    min-width: 0; /* Allow input to shrink */
}
/* Style pour l'icône du calendrier dans les inputs type="date" (webkit) */
#filter-section input[type="date"]::-webkit-calendar-picker-indicator {
    filter: invert(0.8); /* Invert colors for dark theme */
    cursor: pointer; /* Indicate it's clickable */
}
/* Style pour les flèches de spin (optionnel, souvent masqué) */
/* #filter-section input[type="date"]::-webkit-inner-spin-button {
    filter: invert(0.8);
} */

#filter-section input[type="date"]:focus {
    border-color: #00bcd4; /* Accent border on focus */
    outline: none; /* Remove default outline */
}

#filter-section .filter-actions {
    margin-top: 1rem;
    display: flex;
    gap: 0.8rem;
    justify-content: flex-end; /* Align buttons to the right */
}
#filter-section button {
    background-color: #00bcd4; /* Accent color */
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.9rem;
    transition: background-color 0.2s ease; /* Smooth transition on hover */
}
#filter-section button:hover {
    background-color: #0097a7; /* Darken on hover */
}
#filter-section button:active {
    background-color: #006064; /* Even darker on click */
}
#filter-section button#clear-filters-btn {
    background-color: #555; /* Clear button grey */
}
#filter-section button#clear-filters-btn:hover {
     background-color: #666;
}

/* Optional Detail List Section Styling (if re-added) */
/* #detail-list-panel .section-content.list-content { }
#detail-list-panel .list-item {
    border-bottom: 1px solid #333;
    padding: 0.5rem 0;
    font-size: 0.85rem;
    color: #cccccc;
}
#detail-list-panel .list-item:last-child { border-bottom: none; } */


/* Charts Section */
#charts-section .section-content {
    /* Padding already set by .section-content */
    /* Allow the charts container to take full width */
    align-items: stretch;
}
#charts-section .charts-container {
    display: flex;
    flex-wrap: wrap; /* Allow charts to wrap */
    gap: 0.8rem; /* Space between charts */
    justify-content: center; /* Center charts if space allows */
    margin-top: 0.5rem;
    padding: 0;
}
#charts-section .chart-item {
    flex: 1 1 250px; /* Flex-grow, flex-shrink, flex-basis */
    max-width: 100%;
    margin: 0;
    text-align: center;
    background-color: #282828; /* Figure background (can be transparent) */
    padding: 0;
    border-radius: 4px;
    box-shadow: none; /* No shadow on figures themselves if section has one */
    display: flex;
    flex-direction: column; /* Stack image and caption */
    justify-content: space-between; /* Space between img and figcaption */
    overflow: hidden;
}
#charts-section .chart-item img {
    display: block;
    max-width: 100%; /* Image takes full width of figure */
    height: auto; /* Maintain aspect ratio */
    border-radius: 0;
    margin-bottom: 0.5rem;
}
#charts-section .chart-item figcaption {
    font-size: 0.75rem;
    color: #aaaaaa;
    margin-top: auto; /* Push caption to the bottom */
    padding: 0.5rem;
    background-color: #333; /* Caption background */
}


/* Data Table Section */
#data-table-section {
    /* Allow table section to expand in the sidebar if other sections are collapsed */
    flex-grow: 1;
    /* overflow: hidden; /* Sidebar manages global scrolling, simple-datatables manages internal scrolling if fixedHeight is true */
}
#data-table-section .section-content {
    /* fixedHeight: true in JS requires .dataTable-container to have a height */
    /* Simple-datatables adds height to the container, so we might not need specific CSS here */
    /* Ensure table elements are stretched within the flex container */
    align-items: stretch;
    min-height: 0; /* Allow the table content to shrink */
    /* Add some padding to the bottom of the table container if needed */
     padding-bottom: 0.5rem;
}


/* Styles pour le Tableau (thème sombre) */
#fire-table {
    width: 100%; /* Table takes full width of its container */
    border-collapse: collapse; /* Collapse borders */
    margin-top: 0.5rem; /* Space above table (inside .section-content padding) */
    font-size: 0.85rem;
    /* background-color: #282828; /* Simple-datatables might manage background */
}

#fire-table thead { background-color: #333; color: #eeeeee; } /* Header background */
#fire-table th, #fire-table td {
    text-align: left;
    padding: 8px 10px; /* Cell padding */
    border-bottom: 1px solid #444; /* Border below cells */
    color: #cccccc;
}
#fire-table th {
    font-weight: 600;
    text-transform: uppercase;
    font-size: 0.75rem;
    letter-spacing: 0.03em; /* Letter spacing */
}
#fire-table tbody tr:nth-child(even) { background-color: #2e2e2e; } /* Slightly darker even rows */
#fire-table tbody tr:hover { background-color: #383838; cursor: pointer; } /* Highlight on hover */
#fire-table tbody tr:last-child td { border-bottom: none; } /* No border below last row */

/* simple-datatables specific adjustments (Overrides) */
/* The wrapper created by simple-datatables */
.dataTable-wrapper {
     border: 1px solid #444; /* Border around simple-datatables wrapper */
     border-radius: 4px; /* Rounded corners */
     overflow: hidden; /* Ensure content inside respects rounded corners */
     box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); /* Shadow */
     margin-top: 0.5rem; /* Space above wrapper if table n'a pas de margin-top */
     margin-bottom: 0.5rem; /* Space below wrapper */
     flex-grow: 1; /* Allow the wrapper to grow within its flex parent (.section-content) */
     display: flex; /* Simple-datatables uses flex internally */
     flex-direction: column;
     min-height: 0; /* Allow shrinking */
}

/* Style of simple-datatables controls (search, pagination, etc.) */
.dataTable-top, .dataTable-bottom {
     background-color: #282828; /* Controls background */
     color: #cccccc;
     /* Borders removed here as they are on the wrapper .dataTable-wrapper */
     padding: 0.6rem 1rem; /* Controls padding */
     font-size: 0.85rem;
     display: flex; /* Use flex to align elements */
     justify-content: space-between; /* Space out elements */
     align-items: center; /* Vertical alignment */
     flex-wrap: wrap; /* Allow elements to wrap on smaller screens */
     gap: 0.5rem; /* Space between flex items */
     flex-shrink: 0; /* Prevent controls from shrinking */
}

/* The table container managed by simple-datatables (contains the <table>) */
.dataTable-container {
    border: none !important; /* Remove default simple-datatables border */
    overflow-x: auto !important; /* Allow horizontal scrolling if table is too wide */
    /* **FIX:** Ensure vertical scroll for the table body when fixedHeight is true */
    /* Simple-datatables manages overflow-y when fixedHeight is true, but sometimes adding it here helps */
    /* overflow-y: auto !important; */
    background-color: #282828; /* Ensure dark background inside container */
     flex-grow: 1; /* Allow the container to grow within its flex parent (.dataTable-wrapper) */
     min-height: 0; /* Allow the flex item to shrink below its content size */
}
/* Reset styles of the original table after adding the wrapper */
.dataTable-container table {
     border: none !important;
     margin-top: 0 !important; /* Reset margin if simple-datatables adds it */
     background-color: #282828; /* Ensure table background is dark */
}
/* Ensure table cell styles inside the container */
.dataTable-container table thead tr th,
.dataTable-container table tbody tr td {
    /* Padding, borders, colors already defined above for #fire-table */
}


/* Style of inputs (search and select) */
.dataTable-selector, .dataTable-input {
     background-color: #333;
     color: #eeeeee;
     border: 1px solid #555;
     padding: 0.3rem 0.5rem;
     border-radius: 4px;
     font-size: 0.85rem;
     max-width: 180px; /* Limit input width */
     min-width: 0; /* Allow shrinking */
}
.dataTable-selector { padding-right: 1.5rem; } /* Space for select arrow */

/* Style of sort icons */
.dataTable-sorter { color: #eeeeee !important; }
.dataTable-sorter::before, .dataTable-sorter::after { border-bottom-color: #eeeeee !important; border-top-color: #eeeeee !important;}

/* Focus style for inputs */
.dataTable-selector:focus, .dataTable-input:focus { border-color: #00bcd4; outline: none; }

/* Pagination style */
.dataTable-pagination a {
     color: #cccccc;
     background-color: transparent;
     border: 1px solid transparent;
     padding: 0.3rem 0.6rem;
     border-radius: 4px;
     text-decoration: none;
     transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease;
}
.dataTable-pagination li.active a {
     background-color: #00bcd4;
     color: #ffffff !important;
     border-color: #00bcd4;
     font-weight: bold;
}
.dataTable-pagination a:hover:not(.active) {
     background-color: #383838;
     color: #eeeeee;
     border-color: #555;
}
.dataTable-pagination .pager a { padding: 0.3rem; } /* Adjusted padding for arrows */

/* Information on the number of rows style */
.dataTable-info { color: #cccccc; }

/* --- Table Brightness/Emoji Styling --- */
/* Target the brightness column cell (5th column) */
#fire-table tbody td:nth-child(5) {
    white-space: nowrap; /* Prevent wrapping in this cell */
    /* Ensure content is centered if needed, though left-aligned by default */
    /* text-align: center; */
}

/* Style for the span containing the emoji and data-brightness */
.fire-emoji {
    display: inline-block; /* Allows transform and other styles */
    line-height: 1; /* Helps align emoji vertically */
    margin-left: 5px; /* Space between number and emoji */
    vertical-align: middle; /* Vertical alignment */
    font-size: 0.9em; /* Default base size */
    transition: font-size 0.3s ease; /* Smooth size changes */
    transform-origin: center center; /* Origin point for transformations */
    color: inherit; /* Inherit color from parent td by default */
    /* animation: pulse 1.5s infinite ease-in-out; /* Example subtle animation */
}

/* Classes added by the JS script based on data-brightness value */
.fire-emoji.fire-size-medium { /* Brightness > 350 K */
    font-size: 1.1em;
}
.fire-emoji.fire-size-high { /* Brightness > 380 K */
    font-size: 1.3em;
    /* Optional: Change color for high confidence fires */
    /* color: orange; */
}
.fire-emoji.fire-size-veryhigh { /* Brightness > 400 K */
    font-size: 1.5em;
    /* Optional: Change color for very high confidence fires */
    /* color: red; */
    /* animation: pulse 1s infinite ease-in-out; /* More pronounced animation */
}

/* Example Keyframes for a pulse animation if enabled */
/* @keyframes pulse {
    0% { transform: scale(1); opacity: 1; }
    50% { transform: scale(1.1); opacity: 0.8; }
    100% { transform: scale(1); opacity: 1; }
} */


/* --- Map Section --- */
#interactive-map-section {
    grid-area: map; /* Position in 'map' grid area */
    padding: 0; /* No internal padding */
    border-radius: 4px; /* Rounded corners for the section */
    background-color: transparent; /* Transparent background */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); /* Shadow on the section */
    overflow: hidden; /* Ensure iframe inside respects rounded corners */
    /* Height is managed by grid-template-rows: 1fr in main */
     display: flex; /* Use flex to ensure iframe fills container */
     flex-direction: column;
     position: relative; /* For legend positioning */
}
#interactive-map-section h2 { display: none; } /* Hide the map section title */

/* Map Legend */
.map-legend {
    position: absolute;
    top: 10px;
    left: 10px;
    background: rgba(40, 40, 40, 0.95);
    padding: 1rem;
    border-radius: 8px;
    z-index: 1000;
    max-width: 280px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
    border: 1px solid #555;
}

.map-legend h4 {
    margin: 0 0 0.8rem 0;
    color: #00bcd4;
    font-size: 1rem;
    border-bottom: 1px solid #555;
    padding-bottom: 0.5rem;
}

.legend-item {
    display: flex;
    align-items: center;
    margin-bottom: 0.6rem;
    font-size: 0.85rem;
    color: #cccccc;
}

.legend-icon {
    width: 20px;
    height: 20px;
    border-radius: 3px;
    margin-right: 0.6rem;
    flex-shrink: 0;
    border: 1px solid rgba(255, 255, 255, 0.3);
}

.legend-divider {
    height: 1px;
    background: #555;
    margin: 0.8rem 0;
}

.legend-note {
    font-size: 0.8rem;
    color: #aaaaaa;
    line-height: 1.6;
}

.legend-note strong {
    color: #eeeeee;
}

#interactive-map-section iframe {
     width: 100%; /* Iframe takes full width of parent section */
     height: 100%; /* Iframe takes full height of parent section (managed by grid) */
     border: 1px solid #444; /* Border around the iframe */
     border-radius: 4px; /* Rounded corners on iframe */
     box-shadow: none; /* Remove default iframe shadow if any */
     display: block; /* Ensure no space below the iframe */
     box-sizing: border-box; /* Ensure border is included in the size */
     flex-grow: 1; /* Allow iframe to grow within its flex parent */
}


/* --- Footer --- */
footer {
    background-color: #282828;
    color: #aaaaaa;
    text-align: center;
    padding: 0.8rem;
    margin-top: 0.8rem;
    font-size: 0.8rem;
    flex-shrink: 0; /* Prevent footer from shrinking */
}

footer p { margin: 0; }
footer a { color: #00bcd4; text-decoration: none; transition: color 0.3s ease; } /* Link style */
footer a:hover { color: #4dd0e1; text-decoration: underline; } /* Link hover style */


/* --- Responsive Adjustments --- */

/* Tablet and smaller screens (Column Layout) */
@media (max-width: 900px) {
    main {
        display: flex; /* Disable Grid layout */
        flex-direction: column; /* Stack children (sidebar, map) vertically */
        gap: 0.8rem; /* Space between stacked elements */
        padding: 0.6rem; /* Smaller general padding */
        max-width: 100%; /* Use full available width */
        height: auto; /* Allow main to extend beyond viewport height for scrolling */
        min-height: auto; /* Allow shrinking */
         /* Reset calculated height for flex stacking */
        height: auto;
    }

    /* Children of main (sidebar and map) take full width and reset Grid styles */
    #left-sidebar,
    #interactive-map-section {
        grid-area: auto !important; /* Override grid positioning */
        width: auto !important; /* Override fixed/flexible width */
        max-width: none !important;
        height: auto !important; /* Allow height to be determined by content/iframe height */
        max-height: none !important; /* Remove desktop grid max-height constraint */
        overflow-y: visible !important; /* Body handles vertical scrolling if needed */
        padding: 0; /* Remove padding from the sidebar container itself */
        background-color: transparent; /* Make background transparent */
        box-shadow: none; /* Remove shadow from container */
        /* The gap between sections inside sidebar is now handled by the section's parent (#left-sidebar flex gap) */
    }

    /* Styles for sections inside the sidebar (become individual cards, no internal scrolling) */
    #left-sidebar {
        gap: 0.6rem; /* Reduced space between sections on mobile */
         padding: 0; /* No padding on the sidebar itself, sections handle their internal padding */
         background-color: transparent; /* Make background transparent */
         box-shadow: none; /* Remove shadow */
    }

    #left-sidebar section {
         flex-shrink: 0;
         padding: 0; /* Section padding removed */
         box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); /* Add shadow back to individual sections */
         border-radius: 4px;
         overflow: hidden;
         background-color: #282828; /* Section background back for individual cards */
         border: none; /* Remove the border added for desktop sections */
    }
    #left-sidebar section h2 {
         font-size: 1.2rem; /* Reduced title size */
         padding: 0.6rem 0.8rem; /* Reduced padding */
         border-bottom: 1px solid #444;
         border-radius: 3px 3px 0 0; /* Ensure only top corners are rounded */
         background-color: #333; /* Header background */
    }
     #left-sidebar section.collapsed h2 {
         border-bottom: none;
         border-bottom-left-radius: 4px; /* Round bottom corners of header when collapsed */
         border-bottom-right-radius: 4px;
     }

     /* Padding of collapsible content on mobile */
     #left-sidebar section .section-content { padding: 0.8rem; }
     #left-sidebar section.collapsed .section-content { padding-top: 0; padding-bottom: 0;}
     /* Ensure content has rounded corners if section has background */
     #left-sidebar section .section-content {
          border-bottom-left-radius: 4px;
          border-bottom-right-radius: 4px;
          border-top: 1px solid #444; /* Border between header and content */
     }
     #left-sidebar section.collapsed .section-content { border-top: none; } /* No border when collapsed */


    /* Date filters panel responsive adjustments */
    #filter-section .filter-group {
        flex-direction: column; /* Stack label and input */
        align-items: flex-start; /* Align to the left */
        gap: 0.2rem;
    }
    #filter-section label { min-width: auto; } /* Remove min-width */
    #filter-section input[type="date"] { width: 100%; max-width: none;} /* Take full width */
    #filter-section .filter-actions { justify-content: center; } /* Center buttons */

    /* Charts section responsive adjustments */
    #charts-section .charts-container { gap: 0.6rem; margin-top: 0; padding: 0;}
    #charts-section .chart-item {
        flex-basis: 45%; /* About 2 charts per row */
        max-width: none;
        padding: 0.5rem;
        box-shadow: none;
    }
    #charts-section .chart-item figcaption { font-size: 0.7rem;}

   /* Map section responsive adjustments */
   #interactive-map-section { border-radius: 4px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);}
   #interactive-map-section iframe {
       height: 300px; /* **FIX:** Fixed height on mobile */
       border-radius: 4px;
       border: 1px solid #444;
   }

     /* Table section responsive adjustments */
     /* Padding already handled by .section-content */
     #fire-table { margin-top: 0.5rem; }
     #fire-table th, #fire-table td { padding: 6px 8px; font-size: 0.8rem; }
     #fire-table th { font-size: 0.7rem; }
     /* simple-datatables controls on mobile */
     .dataTable-top, .dataTable-bottom {
          padding: 0.5rem;
          font-size: 0.8rem;
          flex-direction: column; /* Stack controls */
          align-items: stretch; /* Stretch to full width */
          gap: 0.3rem;
     }
      /* Ensure sub-groups within controls (search+select, info+pager) stack as well */
     .dataTable-top > div, .dataTable-bottom > div { flex-direction: column; align-items: stretch; gap: 0.3rem;}
     /* simple-datatables inputs take full width */
     .dataTable-selector, .dataTable-input { padding: 0.3rem 0.4rem; font-size: 0.8rem; max-width: none; width: 100%; }


   footer { padding: 0.6rem; font-size: 0.7rem; margin-top: 0.6rem; }
}

/* Téléphones plus petits (ajustements supplémentaires) */
@media (max-width: 600px) {
    header { padding: 0.6rem 0.8rem; margin-bottom: 0.6rem;}
    header .site-logo { height: 40px; }
    header .header-content { flex-direction: column; gap: 0.5rem;}
    header h1 { font-size: 1.5rem; }
    header p { font-size: 0.8rem; }
    /* Auto-refresh indicator becomes static and centered */
    .auto-refresh-indicator { position: static; text-align: center; margin-top: 0.5rem; padding: 0.2rem; background: none; box-shadow: none; color: #cccccc;}
    .auto-refresh-indicator #refresh-countdown { color: #eeeeee;}


    main { gap: 0.6rem; padding: 0.5rem; }
    #left-sidebar { gap: 0.5rem;} /* Even less space between sections */

    #left-sidebar section { padding: 0; }
    #left-sidebar section h2 { font-size: 1.1rem; padding: 0.5rem 0.6rem; }
     #left-sidebar section .section-content { padding: 0.6rem; }


    #stats-section .metric { margin-bottom: 0.8rem; padding-bottom: 0.6rem; border-bottom: 1px solid #444; }
    #stats-section .metric:last-child { border-bottom: none; }
    #stats-section .metric .number { font-size: 2.4rem; }
    #stats-section .metric .label { font-size: 0.8rem; }


    #charts-section .charts-container { gap: 0.5rem; margin-top: 0; padding: 0;}
    #charts-section .chart-item {
        flex-basis: 100%; /* One chart per row */
        max-width: none;
        padding: 0.5rem;
        box-shadow: none;
    }
     #charts-section .chart-item figcaption { font-size: 0.65rem;}


    #interactive-map-section iframe { height: 250px; } /* **FIX:** Even smaller fixed height */

     #fire-table { margin-top: 0.5rem; }
    #fire-table th, #fire-table td { padding: 4px 6px; font-size: 0.75rem; }
    #fire-table th { font-size: 0.65rem; }
     /* simple-datatables controls styles already adjusted in previous media query */
     .dataTable-selector, .dataTable-input { font-size: 0.75rem; }


    footer { padding: 0.5rem; font-size: 0.7rem; margin-top: 0.5rem; }
}

/* Adjustments for the smallest screens if necessary */
@media (max-width: 400px) {
   header .site-logo { height: 35px; }
   header h1 { font-size: 1.3rem; }
   header p { font-size: 0.75rem; }
   #left-sidebar section h2 { font-size: 1rem; padding: 0.4rem 0.5rem;}
    #stats-section .metric .number { font-size: 2rem; }
    #stats-section .metric .label { font-size: 0.7rem; }

    #fire-table th, #fire-table td { font-size: 0.7rem; }
    #fire-table th { font-size: 0.6rem; }
     .dataTable-selector, .dataTable-input { font-size: 0.7rem; }
}

/* ========== ADVANCED FEATURES STYLES ========== */

/* 1. Real-time Alert System */
.fire-alert {
    position: fixed;
    top: 20px;
    right: 20px;
    background: linear-gradient(135deg, #ff6b6b 0%, #ff4444 100%);
    color: white;
    padding: 0;
    border-radius: 8px;
    box-shadow: 0 4px 20px rgba(255, 68, 68, 0.4);
    z-index: 10000;
    max-width: 400px;
    opacity: 0;
    transform: translateX(450px);
    transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
}

.fire-alert.show {
    opacity: 1;
    transform: translateX(0);
}

.fire-alert .alert-content {
    display: flex;
    align-items: center;
    padding: 1rem;
    gap: 1rem;
}

.fire-alert .alert-icon {
    font-size: 2.5rem;
    animation: pulse 1s infinite;
}

.fire-alert .alert-text {
    flex: 1;
}

.fire-alert .alert-text strong {
    display: block;
    font-size: 1.1rem;
    margin-bottom: 0.3rem;
}

.fire-alert .alert-text p {
    margin: 0;
    font-size: 0.9rem;
    opacity: 0.9;
}

.fire-alert .alert-close {
    background: rgba(255, 255, 255, 0.2);
    border: none;
    color: white;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    cursor: pointer;
    font-size: 1.5rem;
    line-height: 1;
    transition: background 0.2s;
}

.fire-alert .alert-close:hover {
    background: rgba(255, 255, 255, 0.3);
}

@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

/* Alert Controls */
.alert-controls {
    display: flex;
    flex-direction: column;
    gap: 0.8rem;
}

.alert-toggle {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    user-select: none;
}

.alert-toggle input[type="checkbox"] {
    width: 20px;
    height: 20px;
    cursor: pointer;
}

.alert-threshold {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.alert-threshold label {
    font-size: 0.9rem;
    color: #cccccc;
}

.alert-threshold input[type="number"] {
    background-color: #333;
    color: #eeeeee;
    border: 1px solid #555;
    padding: 0.4rem;
    border-radius: 4px;
    width: 80px;
    font-size: 0.9rem;
}

.alert-status {
    margin-top: 1rem;
    padding: 0.5rem;
    background-color: #333;
    border-radius: 4px;
    text-align: center;
    font-size: 0.85rem;
    color: #00bcd4;
}

/* 2. Weather Section */
.weather-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0.8rem;
}

.weather-item {
    display: flex;
    flex-direction: column;
    padding: 0.6rem;
    background-color: #333;
    border-radius: 4px;
}

.weather-label {
    font-size: 0.75rem;
    color: #aaaaaa;
    text-transform: uppercase;
    margin-bottom: 0.3rem;
}

.weather-value {
    font-size: 1.2rem;
    font-weight: 600;
    color: #eeeeee;
}

.fire-risk-indicator {
    grid-column: 1 / -1;
    padding: 0.8rem;
    border-radius: 4px;
    text-align: center;
    font-size: 1rem;
    margin-top: 0.5rem;
}

.fire-risk-indicator.risk-low {
    background-color: rgba(0, 255, 0, 0.15);
    color: #00ff00;
    border: 1px solid rgba(0, 255, 0, 0.3);
}

.fire-risk-indicator.risk-medium {
    background-color: rgba(255, 204, 0, 0.15);
    color: #ffcc00;
    border: 1px solid rgba(255, 204, 0, 0.3);
}

.fire-risk-indicator.risk-high {
    background-color: rgba(255, 0, 0, 0.15);
    color: #ff0000;
    border: 1px solid rgba(255, 0, 0, 0.3);
}

.weather-loading {
    text-align: center;
    color: #aaaaaa;
    padding: 1rem;
}

/* 3. Prediction Section */
.prediction-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.prediction-item {
    display: grid;
    grid-template-columns: auto 1fr auto auto;
    gap: 0.8rem;
    padding: 0.6rem;
    background-color: #333;
    border-radius: 4px;
    align-items: center;
    border-left: 3px solid transparent;
    transition: all 0.2s;
}

.prediction-item:hover {
    background-color: #3a3a3a;
    transform: translateX(5px);
}

.prediction-item.risk-high {
    border-left-color: #ff0000;
}

.prediction-item.risk-medium {
    border-left-color: #ffcc00;
}

.prediction-item.risk-low {
    border-left-color: #00ffff;
}

.pred-rank {
    font-weight: 700;
    font-size: 1.1rem;
    color: #00bcd4;
}

.pred-location {
    font-size: 0.85rem;
    color: #cccccc;
}

.pred-fires {
    font-size: 0.8rem;
    color: #aaaaaa;
}

.pred-risk {
    font-size: 0.8rem;
    font-weight: 600;
    padding: 0.2rem 0.5rem;
    background-color: #282828;
    border-radius: 3px;
}

.prediction-loading {
    text-align: center;
    color: #aaaaaa;
    padding: 1rem;
}

/* 4. Historical Section */
.historical-comparison {
    display: flex;
    flex-direction: column;
    gap: 0.8rem;
}

.comparison-item {
    display: flex;
    justify-content: space-between;
    padding: 0.6rem;
    background-color: #333;
    border-radius: 4px;
}

.comp-label {
    font-size: 0.85rem;
    color: #aaaaaa;
}

.comp-value {
    font-size: 1rem;
    font-weight: 600;
    color: #eeeeee;
}

.comparison-trend {
    padding: 0.8rem;
    border-radius: 4px;
    text-align: center;
    font-size: 1.1rem;
    margin-top: 0.5rem;
}

.comparison-trend.trend-up {
    background-color: rgba(255, 0, 0, 0.15);
    color: #ff6b6b;
    border: 1px solid rgba(255, 0, 0, 0.3);
}

.comparison-trend.trend-down {
    background-color: rgba(0, 255, 0, 0.15);
    color: #00ff00;
    border: 1px solid rgba(0, 255, 0, 0.3);
}

.data-count {
    text-align: center;
    font-size: 0.75rem;
    color: #888;
    margin-top: 0.5rem;
}

.historical-loading {
    text-align: center;
    color: #aaaaaa;
    padding: 1rem;
}

.history-btn {
    background-color: #555;
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.85rem;
    margin-top: 0.5rem;
    width: 100%;
    transition: background-color 0.2s;
}

.history-btn:hover {
    background-color: #666;
}

/* 5. Zones of Interest */
.zones-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    margin-bottom: 1rem;
}

.zone-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.6rem;
    background-color: #333;
    border-radius: 4px;
    border-left: 3px solid #00bcd4;
    transition: background-color 0.2s;
}

.zone-item:hover {
    background-color: #3a3a3a;
}

.zone-name {
    font-size: 0.9rem;
    color: #eeeeee;
}

.zone-delete {
    background: none;
    border: none;
    color: #ff6b6b;
    cursor: pointer;
    font-size: 1.2rem;
    padding: 0.2rem 0.5rem;
    transition: color 0.2s;
}

.zone-delete:hover {
    color: #ff4444;
}

.no-zones {
    text-align: center;
    color: #aaaaaa;
    padding: 1rem;
    font-style: italic;
}

.zone-controls {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.8rem;
}

.zone-btn {
    flex: 1;
    background-color: #00bcd4;
    color: white;
    border: none;
    padding: 0.5rem;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.85rem;
    transition: background-color 0.2s;
}

.zone-btn:hover {
    background-color: #0097a7;
}

.zones-loading {
    text-align: center;
    color: #aaaaaa;
    padding: 1rem;
}